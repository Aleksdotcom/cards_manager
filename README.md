# Credit Card Management System
## (Система управления банковскими картами)

Тестовое задание.

*****************************
### Описание задания:

Необходимо разработать backend-часть системы управления банковскими картами с использованием Java и Spring Boot. 
Система должна обеспечивать создание, управление и просмотр данных о банковских картах, а также выполнение операций между картами пользователя.

Каждая карта должна содержать следующие атрибуты:
- Номер карты (masked, хранится в зашифрованном виде)
- Владелец карты
- Срок действия
- Статус карты (Активна, Заблокирована, Истек срок действия)
- Баланс

Система должна предоставлять REST API для взаимодействия с картами, включая фильтрацию и постраничную выдачу.


### Возможности:

1. Сервис поддерживает аутентификацию и авторизацию пользователей по email и паролю.
2. Доступ к API аутентифицирован с помощью JWT токена в заголовке HTTP запроса.
3. Пользователь может: 
   - Просматривать свои карты (с параметризованным поиском и постраничной выдачей).
   - Запрашивать блокировку карты.
   - Совершать переводы между своими картами, если у него есть несколько карт.
4. Администратор может: 
   - создавать, блокировать, активировать и удалять карты; 
   - просматривать все карты; 
   - управлять пользователями.
5. Сервис корректно обрабатывает ошибки и возвращает понятные сообщения, а также валидирует входящие данные.
6. API описан с помощью Open API и Swagger. В сервисе настроен Swagger UI по адресу: `http://localhost:8081/swagger-ui/index.html`.
7. Реализовано несколько базовых юнит-тестов для проверки основных функций контроллера CardController.
8. Использован язык Java 17, Spring, Spring Boot. В качестве БД используется PostgreSQL. Для реализации аутентификации и авторизации используется Spring Security.
9. Настроена миграция базы данных через Liquibase.


## Запуск


* С помощью Docker compose (в системе должен быть установлен Maven, а также установлен и запущен Docker):

```
docker-compose up
```

После запуска приложения переходим на HTTP endpoint `http://localhost:8081/swagger-ui/index.html`.
На странице логина вводим данные одного из пользователей, описанных ниже, и получаем в ответе JWT токен, который необходимо добавить в форме авторизации.

В системе для демонстрации зарегистрировано 2 пользователя, первый - с ролью Администратора, второй - простого Пользователя со следующими реквизитами:
1) email: email@email.com, password: 12345678, role: ADMIN, id: 1
2) email: email1@email.com, password: 12345678, role: USER, id: 51

Для простоты реализации и тестирования заданы следующие ограничения:
- Роль вновь создаваемого юзера по умолчанию: 'USER'. Имя и фамилия автоматически используются
  в поле CARDHOLDER для карты, поэтому должны содержать **только** заглавные латинские буквы.
- Если нужно, Администратор (email: email@email.com, password: 12345678) имеет возможность изменить роль для любого пользователя.
- При создании новой кредитной карты её номер валидируется по алгоритму Луна. Для целей тестирования существует эндпойнт, генерирующий валидные номера.
- При создании новой карты срок её действия должен быть не ранее текущей даты (карта не должна быть "просрочена").
- Баланс карты при любых действиях (создание, трансфер) должен вводиться с двумя знаками после запятой.


URL, доступные без авторизации:
`http://localhost:8081/auth/login` - позволяет пользователю авторизоваться и получить JWT токен, который впоследствии должен при каждом запросе отправлен в HTTP заголовке "Authorization Bearer "+токен.
`http://localhost:8081/auth/sign-up` - позволяет зарегистрировать нового пользователя в системе.
